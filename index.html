<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>C/C++------const用法，尽可能使用const by huolu1987</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">C/C++------const用法，尽可能使用const</h1>
      <h2 class="project-tagline">静静向上的博客</h2>
    </section>

    <section class="main-content">
      <p><a href="http://www.cnblogs.com/xudong-bupt/p/3509567.html">转载链接</a></p>

<h1>
<a id="c-const用法-尽可能使用const" class="anchor" href="#c-const%E7%94%A8%E6%B3%95-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>C++ const用法 尽可能使用const</h1>

<p>　　C++ const 允许指定一个语义约束，编译器会强制实施这个约束，允许程序员告诉编译器某值是保持不变的。如果在编程中确实有某个值保持不变，就应该明确使用const，这样可以获得编译器的帮助。</p>

<p>1.const 修饰成员变量 </p>

<p><code>1 #include&lt;iostream&gt;</code>
 <code>2 using namespace std;</code>
 <code>3 int main(){</code>
 <code>4     int a1=3;   ///non-const data</code>
 <code>5     const int a2=a1;    ///const data</code>
 <code>6</code>
 <code>7     int * a3 = &amp;a1;   ///non-const data,non-const pointer</code>
 <code>8     const int * a4 = &amp;a1;   ///const data,non-const pointer</code>
 <code>9     int * const a5 = &amp;a1;   ///non-const data,const pointer</code>
<code>10     int const * const a6 = &amp;a1;   ///const data,const pointer</code>
<code>11     const int * const a7 = &amp;a1;   ///const data,const pointer</code>
<code>12</code>
<code>13     return 0;</code>
<code>14 }</code>
const修饰指针变量时：</p>

<p>　　(1)只有一个const，如果const位于*左侧，表示指针所指数据是常量，不能通过解引用修改该数据；指针本身是变量，可以指向其他的内存单元。</p>

<p>　　(2)只有一个const，如果const位于*右侧，表示指针本身是常量，不能指向其他内存地址；指针所指的数据可以通过解引用修改。</p>

<p>　　(3)两个const，*左右各一个，表示指针和指针所指数据都不能修改。</p>

<p>2.const修饰函数参数</p>

<p>　　传递过来的参数在函数内不可以改变，与上面修饰变量时的性质一样。</p>

<p><code>void testModifyConst(const int _x) {</code>
     <code>_x=5;　　　///编译出错</code>
<code>}</code></p>

<p>3.const修饰成员函数</p>

<p>(1)const修饰的成员函数不能修改任何的成员变量(mutable修饰的变量除外)</p>

<p>(2)const成员函数不能调用非onst成员函数，因为非const成员函数可以会修改成员变量</p>

<p><code>1 #include &lt;iostream&gt;</code>
 <code>2 using namespace std;</code>
 <code>3 class Point{</code>
 <code>4     public :</code>
 <code>5     Point(int _x):x(_x){}</code>
 <code>6</code>
 <code>7     void testConstFunction(int _x) const{</code>
 <code>8</code>
 <code>9         ///错误，在const成员函数中，不能修改任何类成员变量</code>
<code>10         x=_x;</code>
<code>11</code>
<code>12         ///错误，const成员函数不能调用非onst成员函数，因为非const成员函数可以会修改成员变量</code>
<code>13         modify_x(_x);</code>
<code>14     }</code>
<code>15</code>
<code>16     void modify_x(int _x){</code>
<code>17         x=_x;</code>
<code>18     }</code>
<code>19</code>
<code>20     int x;</code>
<code>21 };</code></p>

<p>4.const修饰函数返回值</p>

<p>(1)指针传递</p>

<p>如果返回const data,non-const pointer，返回值也必须赋给const data,non-const pointer。因为指针指向的数据是常量不能修改。</p>

<p><code>1 const int * mallocA(){  ///const data,non-const pointer</code>
 <code>2     int *a=new int(2);</code>
 <code>3     return a;</code>
 <code>4 }</code>
 <code>5</code>
 <code>6 int main()</code>
 <code>7 {</code>
 <code>8     const int *a = mallocA();</code>
 <code>9     ///int *b = mallocA();  ///编译错误</code>
<code>10     return 0;</code>
<code>11 }</code></p>

<p>(2)值传递</p>

<p>如果函数返回值采用“值传递方式”，由于函数会把返回值复制到外部临时的存储单元中，加const 修饰没有任何价值。所以，对于值传递来说，加const没有太多意义。</p>

<p>所以：</p>

<p>　　不要把函数int GetInt(void) 写成const int GetInt(void)。
　　不要把函数A GetA(void) 写成const A GetA(void)，其中A 为用户自定义的数据类型。</p>

<p>　　在编程中要尽可能多的使用const，这样可以获得编译器的帮助，以便写出健壮性的代码。</p>

      <footer class="site-footer">

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
